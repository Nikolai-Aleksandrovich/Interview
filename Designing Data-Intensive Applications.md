# DDIA

## 什么是可靠、可扩展、可维护的系统？

* ### 可靠性：

  * 硬件故障
  * 软件故障
  * 人为运维失误

* ### 可扩展性

  * #### 描述负载：QPS、数据库写入比例，用户数量、缓存命中

    * 举例：推特2012年有两个峰值：

      * 发布消息：12k/s的发布频率，所有的关注者都会收到
      * 主页时间线浏览：关注者查看所有关注对象的新消息，大概300k/s

    * 解决办法：对每个用户的时间线维护一个缓存，当关注的人发布消息，就把他的消息加到你的缓存中，就不需要进表查询。
    * 优化：
      * 当维持时间线时，对某些不活跃用户，暂时不维持时间线
      * 对某些大V，将他们的数据保证持久化的同时，写到缓存中，所有人都去请求这个缓存。
      * 实际的解决：大V的消息是pull，小v的消息是push。
  
  * #### 描述性能：
  
    * 当负载增加，不改变机器，性能会怎样？
    
    * 当负载增加，不改变性能，机器要怎么变？
    
    * 所以如何描述性能很重要：
    
      * 对于在线服务：响应时间（response time），客户端从发送请求到接受响应之间的时间差
    
        注：延迟和响应时间不一样，延迟更关注请求处理所消耗的时间
    
        * 响应时间不是定值，就算是相同的请求，也会随着各种因素的影响，导致时间不相同
        * 使用百分位数分析响应时间，不要用平均响应时间
          * 中位数称为50百分位数（p50）
          * p95，p99，p999作为响应时间阈值，代表这么多请求响应时间低于比如1.5s



